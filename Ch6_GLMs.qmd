# Generalized Linear Models (GLMs)

## Part 1: Logistic regression

â€¢ All of the regression methods we've seen have involved models in which the response variable is normally distributed, given values for the predictor variables

â€¢ In other words, the residuals have been modeled as normal.

â€¢ What if we have a different kind of response variable? In particular, consider a binary response variable. Maybe the outcomes are "yes" and "no", or "success" and "failure", or "present" and "absent".

â€¢ Logistic regression is a type of "generalized linear model" (GLM) that works well for modeling binary outcome data.

â€¢ Before we get into logistic regression, though, let's see what happens if we use standard regression (sometimes called "ordinary least squares", or OLS regression) with a binary response.

â€¢ We'll use simulated data corresponding to a study of sexual harassment reporting at a university. (Brooks and Perot "Reporting Sexual Harassment: Exploring a Predictive Model" (1991)).

â€¢ Here is data on whether or not sexual harassment at a university was reported, using the offensiveness of the behavior as a predictor variable: â€¢ Data points are "jittered" so that they don't fall right on top of one another.

â€¢ Suppose we want to predict the value of "Report", using "OffensBeh".

â€¢ Here is the linear regression line. In this picture, the response variable takes on the values 0 and 1, and the data are not jittered. â€¢ The predicted value of "Report" can be thought of as the predicted probability that Report=1 (for reported behavior)

â€¢ Note that this line can go below zero and above one. We don't want to predict probability greater than 1! A straight line is not great here. Logistic

### The logistic regression model

Another way of writing a linear regression model

â€¢ By now we are well familiar with the linear regression model:

ğ‘¦ğ‘– = ğ›½0 + ğ›½1ğ‘‹1ğ‘– + ğ›½2ğ‘‹2ğ‘– + â‹¯ + ğ›½ğ‘ğ‘‹ğ‘ğ‘–, +ğœ€ğ‘– ğœ€ğ‘–\~ğ‘ğ‘œğ‘Ÿğ‘šğ‘ğ‘™(0, ğœ)

â€¢ Here is an equivalent way of writing it:

ğ‘¦ğ‘–\~ğ‘ğ‘œğ‘Ÿğ‘šğ‘ğ‘™ ğœ‡ğ‘– = ğ›½0 + ğ›½1ğ‘‹1ğ‘– + ğ›½2ğ‘‹2ğ‘– + â‹¯ + ğ›½ğ‘ğ‘‹ğ‘ğ‘–

â€¢ In other words, the response variable is normally distributed with some mean ğœ‡, and the value of ğœ‡ is determined by the predictor (ğ‘‹) variables.

Writing a logistic regression model

â€¢ We will take this approach to writing the logistic regression model.

â€¢ What we want is a regression equation that looks like this:

ğ‘¦ğ‘– = ğ›½0 + ğ›½1ğ‘‹1ğ‘– + ğ›½2ğ‘‹2ğ‘– + â‹¯ + ğ›½ğ‘ğ‘‹ğ‘ğ‘–

But that will work when ğ‘¦ğ‘– does not follow a normal distribution.

â€¢ Response variable ğ‘¦ takes on the values 0 and 1.

â€¢ Denote the probability that ğ‘¦ = 1 as ğœ‹.

â€¢ This can be written ğ‘¦\~ğµğ‘’ğ‘Ÿğ‘›ğ‘œğ‘¢ğ‘™ğ‘™ğ‘–

(The Bernoulli distribution is a distribution of 1's and 0's, where the probability of 1 is ğœ‹ and the probability of 0 is 1 âˆ’ ğœ‹)

â€¢ We will use regression to model ğœ‹, the probability that ğ‘¦ = 1. This is often thought of as the probability of a "success".

â€¢ If we wanted, we could use this model:

ğ‘¦ğ‘–\~ğµğ‘’ğ‘Ÿğ‘›ğ‘œğ‘¢ğ‘™ğ‘™ğ‘– ğœ‹ğ‘– ğœ‹ğ‘– = ğ›½0 + ğ›½1ğ‘‹1ğ‘– + ğ›½2ğ‘‹2ğ‘– + â‹¯ + ğ›½ğ‘ğ‘‹ğ‘ğ‘–

â€¢ The Bernoulli distribution is a distribution of 1's and 0's, where the probability of 1 is ğœ‹ and the probability of 0 is 1 âˆ’ ğœ‹.

â€¢ The standard deviation of a Bernoulli distribution is ğœ‹(1 âˆ’ ğœ‹ ). So, ğœ‹ is the only parameter for this distribution. This is different from the normal distribution, which has two parameters ğœ‡ and ğœ.

â€¢ But, as we saw in the opening example, a linear model for probability can have serious deficiencies.

â€¢ So, instead of a linear model for probability ğœ‹, we'll make a linear model for a function of ğœ‹, so that the variable on the left hand side of the equation is linearly related to the variable(s) on the right.

â€¢ In logistic regression, we use the "logit" function, also known as "log odds"

ğ‘™ğ‘œğ‘”ğ‘–ğ‘¡

= ln

= "ğ‘™ğ‘œğ‘” ğ‘œğ‘‘ğ‘‘ğ‘ "

â€¢ Applied to our sexual harassment example, we would like to predict the probability that harassing behavior is reported. This probability is denoted ğœ‹

â€¢ Plugging this into the logit formula:

ğ‘™ğ‘œğ‘”ğ‘–ğ‘¡

= ln

= "ğ‘™ğ‘œğ‘” ğ‘œğ‘‘ğ‘‘ğ‘ " ğ‘œğ‘“ ğ‘Ÿğ‘’ğ‘ğ‘œğ‘Ÿğ‘¡ğ‘–ğ‘›ğ‘”

â€¢ This will be our response variable for logistic regression.

â€¢ Logit vs. probability, visually:

### Odds

â€¢ To understand logistic regression, you'll need to understand odds.

â€¢ In casual English, "odds" and "probability" are often used interchangeably.

â€¢ In statistics, they are not the same thing. Odds tell you how likely one outcome is compared to another.

â€¢ For instance, you might hear that a football team has been given "3 to 2" odds of winning a game. This means that their probability of winning is 3Î¤2 = 1.5 times as big as their probability of losing. Or, that they'd be expected to win 3 times for every 2 times they lost.

â€¢ Formally, consider some outcome A, where the probability of A occurring is written as "ğ‘ƒ(ğ´)". In this case,

ğ‘œğ‘‘ğ‘‘ğ‘ 

ğ‘ƒ(ğ´)

1 âˆ’ ğ‘ƒ(ğ´)

ğ‘ğ‘Ÿğ‘œğ‘ğ‘ğ‘ğ‘–ğ‘™ğ‘–ğ‘¡ğ‘¦ ğ´ ğ‘œğ‘ğ‘ğ‘¢ğ‘Ÿğ‘ 

ğ‘ğ‘Ÿğ‘œğ‘ğ‘ğ‘ğ‘–ğ‘™ğ‘–ğ‘¡ğ‘¦ ğ´ ğ‘‘ğ‘œğ‘’ğ‘  ğ‘›ğ‘œğ‘¡ ğ‘œğ‘ğ‘ğ‘¢ğ‘Ÿ

â€¢ This is the ratio of the probability A occurs to the probability A does not occur.

â€¢ Some probabilities and their associated odds:

â€¢ Think of odds(A) as "how many times will A occur for every time A does not occur?"

â€¢ Sometimes we add "to 1" to an odds statement, e.g. "odds of 4 to 1" means "this outcomes occurs 4 times for every 1 time

Back to the logistic regression model

â€¢ The response variable for logistic regression, again, is:

ğ‘™ğ‘œğ‘”ğ‘–ğ‘¡

= ln

= "ğ‘™ğ‘œğ‘” ğ‘œğ‘‘ğ‘‘ğ‘ "

â€¢ So, the full logistic regression model is :

ğ‘¦ğ‘–\~ğµğ‘’ğ‘Ÿğ‘›ğ‘œğ‘¢ğ‘™ğ‘™ğ‘–

â€¢ We are not actually interested in log odds; we only make this conversion

for mathematical convenience. So, once we have ğ‘™ğ‘œğ‘”ğ‘–ğ‘¡ ğœ‹à·œğ‘– back via the inverse logit function:

, we can get

ğ‘™ğ‘œğ‘”ğ‘–ğ‘¡âˆ’1

â€¢ In the context of the logistic regression model:

### jamovi example

â€¢ Applying this to the harassment data, we use Linear Models / Generalized Linear Models in jamovi and select Logistic under Categorical dependent variable.

â€¢ Note that "Target Level" defaults to zero. Changing it to 1 makes sense in this case; we want to predict ğ‘ƒ(ğ‘…ğ‘’ğ‘ğ‘œğ‘Ÿğ‘¡ğ‘’ğ‘‘).

â€¢ jamovi also produces a Loglikelihood ratio test, but we will just focus on "Parameter Estimates":

â€¢ Here is our estimated model:

ğ‘™ğ‘œğ‘” ğ‘œğ‘‘ğ‘‘ğ‘  = âˆ’1.7976 + 0.4869 âˆ— ğ‘‚ğ‘“ğ‘“ğ‘’ğ‘›ğ‘ ğµğ‘’â„

â€¢ Plugging in large and small values for OffensBeh:

ğ‘™ğ‘œğ‘” ğ‘œğ‘‘ğ‘‘ğ‘  ğ‘…ğ‘’ğ‘ğ‘œğ‘Ÿğ‘¡ğ‘’ğ‘‘ = âˆ’1.7976 + 0.4869 âˆ— 1 = âˆ’1.3107 ğ‘™ğ‘œğ‘” ğ‘œğ‘‘ğ‘‘ğ‘  ğ‘…ğ‘’ğ‘ğ‘œğ‘Ÿğ‘¡ğ‘’ğ‘‘ = âˆ’1.7976 + 0.4869 âˆ— 8 = 2.0976

ğœ‹à·œ\|ğ‘‚ğ‘“ğ‘“ğ‘’ğ‘›ğµğ‘’â„ = 1:

ğ‘’âˆ’1.3107 1 + ğ‘’âˆ’1.3107 =

0.2696 = 0.21 1.2696

ğœ‹à·œ\|ğ‘‚ğ‘“ğ‘“ğ‘’ğ‘›ğµğ‘’â„ = 1:

ğ‘’2.0976 1 + ğ‘’2.0976 =

8.1466 = 0.89 9.1466

â€¢ The slope coefficient is directly interpreted as change in log odds for a one unit increase in the predictor. "Log odds" are not of direct interest.

â€¢ Exponentiating both sides of the equation gives straight odds

ğ‘œğ‘‘ğ‘‘ğ‘  =

= ğ‘’ğ›½0+ğ›½1ğ‘‹1ğ‘–+ğ›½2ğ‘‹2ğ‘–+â‹¯+ğ›½ğ‘ğ‘‹ğ‘ğ‘–

â€¢ This means that, for a one unit increase in ğ‘‹1, odds are multiplied by ğ‘’ğ›½1

â€¢ For the harassment data:

ğ‘™ğ‘œğ‘” ğ‘œğ‘‘ğ‘‘ğ‘  = âˆ’1.7976 + 0.4869 âˆ— ğ‘‚ğ‘“ğ‘“ğ‘’ğ‘›ğ‘ ğµğ‘’â„

â€¢ ğ›½áˆ˜ = 0.4869. So, for a one unit increase in OffensBeh, predicted odds of reporting are multiplied by ğ‘’0.4869 = 1.627

â€¢ In other words, there is about a 63% increase in odds of reporting when OffensBeh increases by one. NOTE: odds are not probabilities!

â€¢ Comparing probabilities and odds from this model:

OffensBeh P(Report) Odds(Report) 1 0.212 0.27 2 0.305 0.44 3 0.417 0.71 4 0.537 1.16 5 0.654 1.89 6 0.755 3.08 7 0.834 5.01 8 0.891 8.15 9 0.930 13.26 10 0.956 21.57

## Part 2: Poisson and negative binomial regression

We'll now look at two other popular GLMs: Poisson ("pwa-sawn" roughly) and negative binomial.

â€¢ These are used for modeling count data, which can be extended to how often a categorical variable takes on some value. Thus Poisson regression can be used to model contingency table data.

### The Poisson distribution

â€¢ The Poisson distribution is a discrete probability distribution. A Poisson distributed variable takes on only positive integer values. The integer is referred to as "count" or "\# of events".

â€¢ The Poisson distribution has a single parameter, ğœ† ("lambda"), which is sometimes called the "rate" parameter.

â€¢ ğœ† is both the mean and the variance of a Poisson distribution

â€¢ The probability function for the Poisson is: ğœ†ğ‘˜

ğ‘ƒ

= ğ‘’ğœ†ğ‘˜! 4

Visualizing the Poisson distribution

ğœ† = 1

ğœ† = 2

ğœ† = 5

ğœ† = 10

### The structure of a GLM

â€¢ In logistic regression, the response variable was ğ‘™ğ‘œğ‘”ğ‘–ğ‘¡(ğœ‹) = ln

â€¢ In Poisson regression, the response variable is ln(ğœ†)

â€¢ The reasoning will be that the natural log allows the estimated rate to be modeled as a linear function of some predictor variables.

â€¢ This is how GLMs work: they allow us to use non-normal response variables by expressing a function of their mean as a linear function of the predictors.

â€¢ A GLM has three parts:

1.  A response variable with some distribution

2.  A "link function", ğ‘”(âˆ™), that is applied to the mean of the response variable.

3.  A linear expression of the predictor variables: ğ›½0 + ğ›½1ğ‘‹2 + ğ›½2ğ‘‹2 + â‹¯

GLM examples

â€¢ Logistic regression uses ğ‘¦\~ğµğ‘’ğ‘Ÿğ‘›ğ‘œğ‘¢ğ‘™ğ‘™ğ‘–(ğœ‹) as the response variable and

ğ‘”

= ln

as the link function.

â€¢ Poisson regression uses ğ‘¦\~ğ‘ƒğ‘œğ‘–ğ‘ ğ‘ ğ‘œğ‘›(ğœ†) as the response variable and ğ‘” = ln(ğœ†) as the link function.

â€¢ Ordinary least squares (OLS) regression can also be considered a special case of a GLM. It uses ğ‘¦\~ğ‘ğ‘œğ‘Ÿğ‘šğ‘ğ‘™(ğœ‡, ğœ) and the response variable and the identity function, ğ‘” = ğœ‡ as the link.

â€¢ It's worth briefly noting that the mathematical method used to come up with parameter estimates for GLMs is not "least squares". So, we are not getting our ğ›½áˆ˜ğ‘  by minimizing sums of squared residuals.

â€¢ Instead, the estimation procedure we use is called "maximum likelihood". This method finds the values of the parameter estimates that maximize (i.e. make as large as possible for a given set of data) something called "the likelihood function".

â€¢ The likelihood function takes a fixed set of data and an assumed distribution (e.g. normal), and gives the "probability of the data", given

â€¢ So, if we have:

ğ‘Œğ‘–\~ğ‘ğ‘œğ‘Ÿğ‘šğ‘ğ‘™

â€¢ Then the likelihood function is:

â€¢ Values of ğ›½áˆ˜ , ğ›½áˆ˜ , ğœà·œ are found that maximize this function, i.e. that maximize the probability of the data, given the parameter estimates.

### Poisson regression example

â€¢ We'll use some General Social Survey data for this example.

â€¢ Poisson is good for modeling count data, so we'll use a response variable that takes the form of counts.

â€¢ For this example, the goal will be to look at the relationship (if any) between the number of sibling a person has, and the number of children that person has.

â€¢ Our question will be: do people with more siblings tend to have more children? And if so, can we quantify the relationship?

â€¢ It would be wise to collect data on covariates that we expect will also be related to the number of children someone has.

â€¢ An obvious one is age. Older people will have more children than younger people.

â€¢ We might also want to control for "culture". If people from different cultural backgrounds tend to have more or fewer children, then this would definitely induce a relationship between \# of siblings and \# of children.

â€¢ There are lots of possible ways to try account for cultural background.

â€¢ So, the variables will be:

â€¢ \# of children â€¢ \# of siblings â€¢ Age â€¢ Frequency of attending religious services

â€¢ We'll just look at 2018 data. The GSS lets us choose any years we want, going back to 1972.

â€¢ This data set is on Canvas, as GSS_Children_Siblings.jmp

â€¢ First thing to do is plot our variables.

â€¢ Yikes! There's some cleaning to do. The instances of 98 siblings are not real data points.

â€¢ GSS data explorer website lets us look in detail at each variable. Here is part of the coding for "SIBS":

â€¢ And here's the coding for the variable CHILDS.

â€¢ So, CHILDS = 9 is a value for missing data. These should also be excluded.

â€¢ This should feel familiar -- remember how messy the NLSY data was in the heights analysis?

â€¢ Keep in mind that data in public databases often have idiosyncrasies like this.

â€¢ Here are the row selection options that will select all rows with invalid responses.

â€¢ Once selected, they can be excluded.

â€¢ Here is the distribution of CHILDS. â€¢ This looks a lot like a Poisson distribution. Hooray!

â€¢ To run the regression, use Linear Models / Generalized Linear Models and choose Poisson(overdispersion) for Frequencies.

â€¢ Here are results for a simple model, where \# of siblings is the sole predictor of \# of children. We'll just look at the parameter estimates and the overdispersion statistic:

â€¢ Letting

ğœ†áˆ˜

represent the predicted mean \# of children, we have:

ln = 0.375 + 0.0631(ğ‘†ğ¼ğµğ‘†)

â€¢ You might not be surprised to learn that, due to the log link, the exponentiated slope is interpreted as the multiplicative change in the estimated value of the response variable, given a one unit increase in the predictor variable. ğ‘’0.0627 = 1.065\
â€¢ So, increasing \# of siblings by one is associated with an 6.5% increase in \# of children.

â€¢ We can see that this is statistically significant, but it is also small.

â€¢ It is also not obvious that % change is the best way to quantify this. Maybe an OLS model would have been more interpretable.

â€¢ It might be more desirable to relate an additive change in siblings to an additive change in children.

â€¢ Downside is that \# of children is not normally distributed.

â€¢ As is often the case, we are trading some interpretability for a better

â€¢ The Poisson distribution makes a strong assumption: the mean should be equal to the variance.

â€¢ Often, we observe real data in which the variance is greater than the mean.

â€¢ This is referred to as "overdispersion".

â€¢ If mean = variance, this should be equal to 1. But it rarely is.

â€¢ If there is strong overdispersion, a negative binomial model will fit better.

â€¢ The overdispersion statistic is the ratio of the Pearson chi-square statistic to its degrees of freedom..

â€¢ For these data, it turns out that \# of siblings, age, frequency of attending religious services, and the interactions between age and the other two variables are all statistically significant and all improve model fit. Here are the parameter estimate results for this model:

â€¢ The other predictor variables and the interactions can be interpreted in the usual ways.

â€¢ One thing to notice is that the estimate for SIBS has not changed much. So, while the other covariates and interactions matter, they don't substantially change our interpretation of the SIBS predictor.

### Negative binomial regression

â€¢ There is also still some overdispersion, though less than there was before:

â€¢ Remember that the Poisson distribution only has one parameter. This limits its flexibility.

â€¢ The negative binomial distribution is similar to the Poisson distribution, but it is more flexible, and may be a better choice in the presence of overdispersion.

â€¢ The negative binomial distribution is also a distribution for count data. It is interpreted as giving the number of "success" before a certain number of "failures" occur.

â€¢ There are two parameters: ğ‘, the probability of success, and ğ‘Ÿ, the number of failures at which counting stops.

â€¢ The mean of the negative binomial distribution is ğ‘Ÿ

= ğ‘Ÿ âˆ— ğ‘œğ‘‘ğ‘‘ğ‘ (ğ‘ ğ‘¢ğ‘ğ‘ğ‘’ğ‘ ğ‘ )

â€¢ Example: suppose ğ‘ = 0.8 and ğ‘Ÿ = 2. We expect 2âˆ—0.8

= 8 success before

â€¢ If a variable ğ‘¦ is distributed negative binomial, we denote it:

ğ‘¦\~ğ‘ğµ(ğ‘Ÿ, ğ‘)

â€¢ The mean of the negative binomial distribution is ğ‘Ÿ

= ğ‘Ÿ âˆ— ğ‘œğ‘‘ğ‘‘ğ‘ (ğ‘ ğ‘¢ğ‘ğ‘ğ‘’ğ‘ ğ‘ )

â€¢ Example: suppose ğ‘ = 0.8 and ğ‘Ÿ = 2. We expect 2âˆ—0.8

= 8 success before

we observe two failures.

â€¢ Or suppose ğ‘ = 0.5 and ğ‘Ÿ = 1. We expect 1âˆ—0.5

= 1 success before we

observe 1 failure.

â€¢ For practical purposes, negative binomial regression will show better fit than Poisson regression in the presence of overdispersion.

â€¢ The tradeoff is that the interpretation is less generally applicable. It might not make sense to think of your count variable as \# of successes for a certain \# of failures.

â€¢ As with Poisson regression, negative binomial regression uses a GLM with a log link.

Negative binomial example

â€¢ Here is where you select negative binomial regression in jamovi:

â€¢ Under "Generalized Linear Models", under "Frequencies" choose "Negative Binomial".

Negative binomial results

â€¢ These results are awfully similar to the Poisson results.

â€¢ It is often the case that different statistical methods designed for the same purpose will with similar results.
