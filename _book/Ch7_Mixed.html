<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.361">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>STAT 331 - 7&nbsp; Chapter 7: Mixed-effects models</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./Ch8_Mind_the_Gap.html" rel="next">
<link href="./Ch6_GLMs.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./Ch7_Mixed.html"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Chapter 7: Mixed-effects models</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">STAT 331</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction to STAT 331: Intermediate Applied Statistical Methods</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Ch1_Review.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Chapter 1: Review of classical inference</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Ch2_Model_Building.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Chapter 2: Model building with linear regression</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Ch3_Model_Fit.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Chapter 3: Assessing and improving model fit</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Ch4_ANOVA.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Chapter 4: ANOVA-based methods</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Ch5_Categorical.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Chapter 5: Analyzing categorical data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Ch6_GLMs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Generalized Linear Models (GLMs)</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Ch7_Mixed.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Chapter 7: Mixed-effects models</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Ch8_Mind_the_Gap.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Chapter 8: Minding the gap between science and statistics</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Ch9_Other_Topics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Brief looks at major topics we didn’t cover</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="99">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#outline-of-notes" id="toc-outline-of-notes" class="nav-link active" data-scroll-target="#outline-of-notes">Outline of notes</a></li>
  <li><a href="#repeated-measures" id="toc-repeated-measures" class="nav-link" data-scroll-target="#repeated-measures"><span class="header-section-number">7.1</span> Repeated measures</a></li>
  <li><a href="#the-independence-assumption" id="toc-the-independence-assumption" class="nav-link" data-scroll-target="#the-independence-assumption"><span class="header-section-number">7.2</span> The independence assumption</a></li>
  <li><a href="#cheating-with-repeated-measures" id="toc-cheating-with-repeated-measures" class="nav-link" data-scroll-target="#cheating-with-repeated-measures"><span class="header-section-number">7.3</span> Cheating with repeated measures</a>
  <ul class="collapse">
  <li><a href="#what-happened" id="toc-what-happened" class="nav-link" data-scroll-target="#what-happened"><span class="header-section-number">7.3.1</span> What happened?</a></li>
  <li><a href="#effective-sample-size" id="toc-effective-sample-size" class="nav-link" data-scroll-target="#effective-sample-size"><span class="header-section-number">7.3.2</span> Effective sample size</a></li>
  </ul></li>
  <li><a href="#cheating-ourselves-with-repeated-measures" id="toc-cheating-ourselves-with-repeated-measures" class="nav-link" data-scroll-target="#cheating-ourselves-with-repeated-measures"><span class="header-section-number">7.4</span> Cheating ourselves with repeated measures</a>
  <ul class="collapse">
  <li><a href="#converting-from-wide-to-long-form" id="toc-converting-from-wide-to-long-form" class="nav-link" data-scroll-target="#converting-from-wide-to-long-form"><span class="header-section-number">7.4.1</span> Converting from wide to long form</a></li>
  <li><a href="#plotting-the-data" id="toc-plotting-the-data" class="nav-link" data-scroll-target="#plotting-the-data"><span class="header-section-number">7.4.2</span> Plotting the data</a></li>
  <li><a href="#analyzing-the-data" id="toc-analyzing-the-data" class="nav-link" data-scroll-target="#analyzing-the-data"><span class="header-section-number">7.4.3</span> Analyzing the data</a></li>
  <li><a href="#analyzing-the-data-assuming-independence" id="toc-analyzing-the-data-assuming-independence" class="nav-link" data-scroll-target="#analyzing-the-data-assuming-independence"><span class="header-section-number">7.4.4</span> Analyzing the data, assuming independence</a></li>
  <li><a href="#analyzing-the-data-accounting-for-cows" id="toc-analyzing-the-data-accounting-for-cows" class="nav-link" data-scroll-target="#analyzing-the-data-accounting-for-cows"><span class="header-section-number">7.4.5</span> Analyzing the data, accounting for cows</a></li>
  <li><a href="#side-by-side-comparison" id="toc-side-by-side-comparison" class="nav-link" data-scroll-target="#side-by-side-comparison"><span class="header-section-number">7.4.6</span> Side by side comparison</a></li>
  </ul></li>
  <li><a href="#challenges-and-opportunities-with-repeated-measures-data" id="toc-challenges-and-opportunities-with-repeated-measures-data" class="nav-link" data-scroll-target="#challenges-and-opportunities-with-repeated-measures-data"><span class="header-section-number">7.5</span> Challenges and opportunities with repeated measures data</a></li>
  <li><a href="#random-effects" id="toc-random-effects" class="nav-link" data-scroll-target="#random-effects"><span class="header-section-number">7.6</span> Random effects</a>
  <ul class="collapse">
  <li><a href="#subjects-and-nesting" id="toc-subjects-and-nesting" class="nav-link" data-scroll-target="#subjects-and-nesting"><span class="header-section-number">7.6.1</span> Subjects and Nesting</a></li>
  </ul></li>
  <li><a href="#the-mixed-effects-model" id="toc-the-mixed-effects-model" class="nav-link" data-scroll-target="#the-mixed-effects-model"><span class="header-section-number">7.7</span> The mixed effects model</a>
  <ul class="collapse">
  <li><a href="#the-mixed-effects-model-in-jamovi" id="toc-the-mixed-effects-model-in-jamovi" class="nav-link" data-scroll-target="#the-mixed-effects-model-in-jamovi"><span class="header-section-number">7.7.1</span> The mixed effects model in jamovi</a></li>
  <li><a href="#slope-coding-in-mixed-model" id="toc-slope-coding-in-mixed-model" class="nav-link" data-scroll-target="#slope-coding-in-mixed-model"><span class="header-section-number">7.7.2</span> Slope coding in “Mixed Model”</a></li>
  </ul></li>
  <li><a href="#applied-example-the-liking-gap" id="toc-applied-example-the-liking-gap" class="nav-link" data-scroll-target="#applied-example-the-liking-gap"><span class="header-section-number">7.8</span> Applied example: “The liking gap”</a>
  <ul class="collapse">
  <li><a href="#the-liking-gap-example" id="toc-the-liking-gap-example" class="nav-link" data-scroll-target="#the-liking-gap-example"><span class="header-section-number">7.8.1</span> The liking gap example</a></li>
  <li><a href="#fitting-the-model-in-jamovi" id="toc-fitting-the-model-in-jamovi" class="nav-link" data-scroll-target="#fitting-the-model-in-jamovi"><span class="header-section-number">7.8.2</span> Fitting the model in jamovi</a></li>
  <li><a href="#adding-an-interaction" id="toc-adding-an-interaction" class="nav-link" data-scroll-target="#adding-an-interaction"><span class="header-section-number">7.8.3</span> Adding an interaction…</a></li>
  </ul></li>
  <li><a href="#replicating-a-published-mixed-model-analysis" id="toc-replicating-a-published-mixed-model-analysis" class="nav-link" data-scroll-target="#replicating-a-published-mixed-model-analysis"><span class="header-section-number">7.9</span> Replicating a published mixed model analysis</a>
  <ul class="collapse">
  <li><a href="#worked-example-overview" id="toc-worked-example-overview" class="nav-link" data-scroll-target="#worked-example-overview"><span class="header-section-number">7.9.1</span> Worked example overview</a></li>
  <li><a href="#paper-abstract" id="toc-paper-abstract" class="nav-link" data-scroll-target="#paper-abstract"><span class="header-section-number">7.9.2</span> Paper abstract</a></li>
  <li><a href="#study-1" id="toc-study-1" class="nav-link" data-scroll-target="#study-1"><span class="header-section-number">7.9.3</span> Study 1</a></li>
  <li><a href="#study-3" id="toc-study-3" class="nav-link" data-scroll-target="#study-3"><span class="header-section-number">7.9.4</span> Study 3</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Chapter 7: Mixed-effects models</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>This chapter covers “mixed-effect” regression and ANOVA models in which some of the coefficients are modeled as random values drawn from a distribution, rather than fixed values that exist at the population level. Mixed models are particularly useful when you have data where individuals are measured more than once.</p>
<section id="outline-of-notes" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="outline-of-notes">Outline of notes</h2>
<ol type="1">
<li>Repeated measures</li>
<li>The independence assumption</li>
<li>Cheating with repeated measures</li>
<li>Cheating ourselves with repeated measures</li>
<li>Challenges and opportunities with repeated measures data</li>
<li>Random effects</li>
<li>The mixed effects model</li>
<li>Applied example: “The liking gap”</li>
<li>Replicating a published mixed model analysis</li>
</ol>
</section>
<section id="repeated-measures" class="level2" data-number="7.1">
<h2 data-number="7.1" class="anchored" data-anchor-id="repeated-measures"><span class="header-section-number">7.1</span> Repeated measures</h2>
<p>“Repeated measures” refers to measuring the same subjects (people, trees, dogs, cities, cells, widgets, etc) more than once.</p>
<p>Studies that use repeated measures are often referred to as “within subjects” studies. The idea is that multiple measurements within the same subject will be compared.</p>
<p>Mixed models are popular tools for analyzing repeated measures data; we’ll get to these later in the notes. For now, we’ll consider the problems and opportunities that arise from the use of repeated measures data.</p>
</section>
<section id="the-independence-assumption" class="level2" data-number="7.2">
<h2 data-number="7.2" class="anchored" data-anchor-id="the-independence-assumption"><span class="header-section-number">7.2</span> The independence assumption</h2>
<p>We have looked at model assumptions in this class, e.g.</p>
<p><span class="math display">\[
\epsilon_i \sim Normal(0, \sigma)
\]</span></p>
<p>There is one that has been left out. The complete way to write this statement is:</p>
<p><span class="math display">\[
\epsilon_i \overset{iid}\sim Normal(0, \sigma)
\]</span></p>
<p>The “iid” means “independent and identically distributed.</p>
<p><span class="math inline">\(\epsilon_i \overset{iid}\sim Normal(0, \sigma)\)</span> says that <span class="math inline">\(\epsilon_i\)</span> takes on values that are independently sampled from the same normal distribution.</p>
<p>“independently sampled” means that the value of the next data point is not dependent upon the value of the previous data point.</p>
<p>Every method we have used assumes independence of the response variable, conditional on the predictor(s).</p>
<p>But, if the same subjects are measured multiple times, then the multiple observations on each subject will not be independent.</p>
<p>Example: suppose we take a random sample of 10 people, have each solve a maze, and record how much time it takes each person to solve it. Call this time <span class="math inline">\(T\)</span>.</p>
<p>We might model the times as i.i.d. normal:</p>
<p><span class="math display">\[
T_i \overset{iid}\sim Normal( \mu, \sigma)
\]</span></p>
<p>This means that, given a mean and standard deviation, each observed time <span class="math inline">\(T_i\)</span> is uncorrelated with any previous times. This should make sense: there is no reason that the <span class="math inline">\(3^{rd}\)</span> person’s maze time should depend upon the <span class="math inline">\(2^{nd}\)</span> person’s maze time.</p>
<p>But, if we take repeated measures on each subject, then our data will not be independent.</p>
<p>For instance, suppose we have 10 observations on maze completion from 2 people, where the first 5 come from one person and the last 5 come from the other.</p>
<p>Then I would expect correlation (non-independence) between the first 5 maze times, and between the last 5 times. Observation 5 should be closer to observations 1-4 than it is to observations 6-10.</p>
</section>
<section id="cheating-with-repeated-measures" class="level2" data-number="7.3">
<h2 data-number="7.3" class="anchored" data-anchor-id="cheating-with-repeated-measures"><span class="header-section-number">7.3</span> Cheating with repeated measures</h2>
<p>We will look at a fake data simulation of repeated measures data.</p>
<p>In this simulation, suppose we have cows infected with the Staph bacteria.</p>
<p>We are comparing two treatments for Staph. We have 6 cows, and each treatment is randomly assigned to 3 cows. We will do a t-test to compare mean infection levels (quantified on some arbitrary scale).</p>
<p>We will also assume that the two treatments have an identical effect. Therefore the null hypothesis of no difference in means is true.</p>
<p>The file cows_ttest.jmp has some fake data, simulated as <span class="math inline">\(y_i \sim Normal(12,4)\)</span> for both groups:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/Mod7_pt1_1.png" class="img-fluid figure-img" width="400"></p>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/Mod7_pt1_2.png" class="img-fluid figure-img" width="400"></p>
</figure>
</div>
<p>Not surprisingly, the t-test gives no significant difference in means:</p>
<p><span class="math display">\[
95\% \textit{ CI for } \mu_1 - \mu_2 = (-18.00, 8.07), \text{ p-value} = 0.321
\]</span></p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/Mod7_pt1_3.png" class="img-fluid figure-img"></p>
</figure>
</div>
<p>Now suppose we measure infection level for each cow seven times after receiving treatment.</p>
<p>The file cows_repeated_ttest.csv contains data simulating this scenario.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/Mod7_pt1_4.png" class="img-fluid figure-img" width="400"></p>
</figure>
</div>
<p>For each cow, there are 7 observations. These all average out to the one observation per cow from the last data set.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/Mod7_pt1_5.png" class="img-fluid figure-img"></p>
</figure>
</div>
<p>But check out these t-test results!</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/Mod7_pt1_6.png" class="img-fluid figure-img"></p>
</figure>
</div>
<p>Notice where it says degrees of freedom = 29.2. If your degrees of freedom exceeds your sample size, something is wrong.</p>
<section id="what-happened" class="level3" data-number="7.3.1">
<h3 data-number="7.3.1" class="anchored" data-anchor-id="what-happened"><span class="header-section-number">7.3.1</span> What happened?</h3>
<p>Comparing the two t-tests:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/Mod7_pt1_7.png" class="img-fluid figure-img"></p>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/Mod7_pt1_8.png" class="img-fluid figure-img"></p>
</figure>
</div>
<p>The mean difference is nearly the same for both.</p>
<p>The standard error for the repeated measures data is much smaller.</p>
<p>Remember that the t-test is just a simple regression model:</p>
<p><span class="math display">\[
y_i = \beta_0 + \beta_1Group_i + \epsilon_i \text{ where } \epsilon_i \overset{iid}\sim Normal(0, \sigma)
\]</span></p>
<p>In this case, <span class="math inline">\(\hat{\beta}_1\)</span> is the estimated mean difference in infection levels between the two groups.</p>
<p>There’s nothing wrong with this estimate on its own. However its standard error is computing using an incorrect assumption: that all of the observations within each group are independent.</p>
</section>
<section id="effective-sample-size" class="level3" data-number="7.3.2">
<h3 data-number="7.3.2" class="anchored" data-anchor-id="effective-sample-size"><span class="header-section-number">7.3.2</span> Effective sample size</h3>
<p>In this case, the apparent sample size is <span class="math inline">\(n = 42\)</span>, or <span class="math inline">\(n = 21\)</span> per group.</p>
<p>But the “effective” sample size is <span class="math inline">\(n = 6\)</span>, or <span class="math inline">\(n = 3\)</span> per group.</p>
<p>Taking lots of observations from each animal and doing a t-test on all the data amounts to falsely inflating the sample size without having to actually collect more data.</p>
<p>Main lesson: observations that are correlated should not be treated as independent!</p>
</section>
</section>
<section id="cheating-ourselves-with-repeated-measures" class="level2" data-number="7.4">
<h2 data-number="7.4" class="anchored" data-anchor-id="cheating-ourselves-with-repeated-measures"><span class="header-section-number">7.4</span> Cheating ourselves with repeated measures</h2>
<p>Treating repeated measures as independent can fool us into thinking we’ve discovered an association when really there is none.</p>
<p>It can also do the opposite: it can fool us into thinking we see no association when really there is one.</p>
<p>This will be illustrated with another toy example. In this case, we will again consider collecting data on infection level in cows under two treatments. This time, we’ll imagine collecting repeated observations over the course of a week.</p>
<p>Here are the data in “wide form”. Treatment group B is highlighted to distinguish it from treatment group A.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/Mod7_pt1_9.png" class="img-fluid figure-img"></p>
</figure>
</div>
<ul>
<li><p>Two things to note:</p>
<ul>
<li><p>There is a lot of variability across cows.</p></li>
<li><p>Every cow’s infection rating goes down over time</p></li>
</ul></li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/Mod7_pt1_10.png" class="img-fluid figure-img"></p>
</figure>
</div>
<p>Here are the data in “long form.”</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/Mod7_pt1_11.png" class="img-fluid figure-img" width="400"></p>
</figure>
</div>
<p>Long form is needed for most analyses.</p>
<p>We can use jamovi’s Rj-code editor to wide form to long form. (Though using Excel might be easier)</p>
<p>The following code will convert the data from wide to long form. Note you will need to open the data in a new session of jamovi and rename the Day and Infection_level columns.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/Mod7_pt1_12.png" class="img-fluid figure-img"></p>
</figure>
</div>
<section id="converting-from-wide-to-long-form" class="level3" data-number="7.4.1">
<h3 data-number="7.4.1" class="anchored" data-anchor-id="converting-from-wide-to-long-form"><span class="header-section-number">7.4.1</span> Converting from wide to long form</h3>
<p>We must now transform the Day column of the longform data. We want the variable Day to take on nominal integer values</p>
<p>Double click the Day column and in the Data menu select Transform / Using Transform / Create New Transformation.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/Mod7_pt1_13.png" class="img-fluid figure-img"></p>
</figure>
</div>
</section>
<section id="plotting-the-data" class="level3" data-number="7.4.2">
<h3 data-number="7.4.2" class="anchored" data-anchor-id="plotting-the-data"><span class="header-section-number">7.4.2</span> Plotting the data</h3>
<p>Here is a basic plot of infection rates across time.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/Mod7_pt1_14.png" class="img-fluid figure-img" width="400"></p>
</figure>
</div>
<p>There appears to be a small downward trend, and lots of noise in the data.</p>
<p>But we can account for this noise! It is due to different cows having different overall infection rates.</p>
<p>Here is a similar plot, with the Y axis grouped by treatment.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/Mod7_pt1_15.png" class="img-fluid figure-img" width="400"></p>
</figure>
</div>
<p>This shows a small decrease for treatment B.</p>
<p>But, we are still treating these observations as though they are independent.</p>
<p>They are not independent; they are correlated within each cow.</p>
<p>Here is the same plot, but with “cow_ID” as the overlay variable.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/Mod7_pt1_16.png" class="img-fluid figure-img" width="400"></p>
</figure>
</div>
<p>Each cow now gets its own line. The downward trend for B is clear.</p>
<p>Also, it is now clear that most of the variation in infection rate was due to differences between cows. Once this is accounted for, variability is low.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/Mod7_pt1_17.png" class="img-fluid figure-img" width="400"></p>
</figure>
</div>
</section>
<section id="analyzing-the-data" class="level3" data-number="7.4.3">
<h3 data-number="7.4.3" class="anchored" data-anchor-id="analyzing-the-data"><span class="header-section-number">7.4.3</span> Analyzing the data</h3>
<p>These plots illustrate the idea behind accounting for repeated measures.</p>
<p>In this module, we will learn how to incorporate repeated measures in statistical models.</p>
<p>For now, let’s look at some different way of analyzing the data that we just plotted.</p>
</section>
<section id="analyzing-the-data-assuming-independence" class="level3" data-number="7.4.4">
<h3 data-number="7.4.4" class="anchored" data-anchor-id="analyzing-the-data-assuming-independence"><span class="header-section-number">7.4.4</span> Analyzing the data, assuming independence</h3>
<p>We can run regression models where infection rate is the response variable and some combination of treatment and day are the predictors.</p>
<p>We know both variables matter, and that they interact – the “effect” of day on infection level depends on treatment, and the “effect” of treatment on infection level depends on day.</p>
<p>The next slide shows output for fitting this model:</p>
<p><span class="math display">\[
\textit{Infection level}_i = \beta_0 + \beta_1Treatment + \beta_2Day + \beta_3Treatment*Day + \epsilon_i \\
\text{ where } \epsilon_i \overset{iid}\sim Normal(0, \sigma)
\]</span></p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/Mod7_pt1_18.png" class="img-fluid figure-img"></p>
</figure>
</div>
<p><span class="math inline">\(R^2\)</span> is small, suggesting this model does not explain much variability in infection rates.</p>
<p>Remember, we know that a lot of variability is due to differences between cows. This is all getting “absorbed” by the error term.</p>
<p>Large error variance gives small <span class="math inline">\(R^2\)</span> and large standard errors for slopes</p>
</section>
<section id="analyzing-the-data-accounting-for-cows" class="level3" data-number="7.4.5">
<h3 data-number="7.4.5" class="anchored" data-anchor-id="analyzing-the-data-accounting-for-cows"><span class="header-section-number">7.4.5</span> Analyzing the data, accounting for cows</h3>
<p>Here are results from analyzing these data using a mixed model. This mixed model accounts for differences between cows, and the fact that repeated measures taken on each cow are correlated.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/Mod7_pt1_19.png" class="img-fluid figure-img"></p>
</figure>
</div>
<p>We will cover the details of how mixed models work in the next set of notes. For now, note the much larger <span class="math inline">\(R^2 = 0.83\)</span></p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/Mod7_pt1_20.png" class="img-fluid figure-img"></p>
</figure>
</div>
</section>
<section id="side-by-side-comparison" class="level3" data-number="7.4.6">
<h3 data-number="7.4.6" class="anchored" data-anchor-id="side-by-side-comparison"><span class="header-section-number">7.4.6</span> Side by side comparison</h3>
<p>The mixed model (on the bottom) gives smaller standard errors for Day and the interaction.</p>
<p><img src="images/Mod7_pt1_21.png" class="img-fluid"></p>
<p>Note what didn’t change: the parameter estimates!</p>
</section>
</section>
<section id="challenges-and-opportunities-with-repeated-measures-data" class="level2" data-number="7.5">
<h2 data-number="7.5" class="anchored" data-anchor-id="challenges-and-opportunities-with-repeated-measures-data"><span class="header-section-number">7.5</span> Challenges and opportunities with repeated measures data</h2>
<p>Repeated measures data can be challenging to analyze, if the design gets complicated. We will see some study designs in which it isn’t immediately obvious how to set up an appropriate model.</p>
<p>Repeated measures data can also be analyzed incorrectly (assuming independence) to artificially increase apparent sample size and get strong looking results that are not valid.</p>
<p>But repeated measures data can also be very useful! “Within subject” designs, in which subjects are measured repeatedly across time and / or conditions, can greatly enhance the precision and power of our inferences. This is because variability that would normally be accounted for by the error term can instead be attributed to overall differences between the subjects from whom repeated measurements were taken.</p>
</section>
<section id="random-effects" class="level2" data-number="7.6">
<h2 data-number="7.6" class="anchored" data-anchor-id="random-effects"><span class="header-section-number">7.6</span> Random effects</h2>
<p>The “mixed” in “mixed models” refers to a mix of random effects and fixed effects.</p>
<p>All of the predictor variables we’ve seen all semester have been “fixed effects”. What this means will only make sense in comparison to a new kind of predictor: a “random effect”.</p>
<p>Fixed effects variables are predictor variables for which we “estimate” a slope coefficient, usually denoted with a <span class="math inline">\(\beta\)</span>. We calculate a value for this coefficient using our data, and then we treat this value (usually denoted as a <span class="math inline">\(\hat{\beta}\)</span>) as an estimate for some fixed but unknown population-level parameter.</p>
<p>Sometimes, though, we want our model to account for a variable that is important for explaining variability in the response variable, but for which we do not want to treat its coefficients as estimates of unknown parameters. For instance, in the previous “cows” examples, we’ll want to calculate the mean infection levels for each cow and take these into account. But, it probably doesn’t make sense to treat each cow’s mean as a population level parameter value of interest. After all, if we conducted the study again, we’d have new cows!</p>
<p>Treating this predictor variable as a random effect (or random factor) will accomplish this. Random factors take on values that are treated as having been drawn at random from a larger population of possible values that might be different if we take a new sample. These random factors have coefficients (aka slopes) that are also treated as taking on random values.</p>
<p>So, with the “cows” examples, we imagined measuring the same cows over and over again. “Cow” should probably be treated as a random factor in these cases. The cows themselves were drawn from a larger population; we would not get the same cows again in a new study.</p>
<p>Also, we wanted to account for differences in the mean infection levels for each individual cow, so that we could estimate standard errors appropriate to our study designs. And these mean infection levels should also be treated as random, in that they came from some population of possible mean infection levels.</p>
<p>So, the cows are random, and their coefficients are random.</p>
<p>There are many interpretations of a “random effect”, and they aren’t always helpful. From a 2005 paper by Andrew Gelman:</p>
<ol type="1">
<li>Fixed effects are constant across individuals, and random effects vary.</li>
</ol>
<!-- -->
<ol start="2" type="1">
<li><p>Effects are fixed if they are interesting in themselves or random if there is interest in the underlying population.</p></li>
<li><p>When a sample exhausts the population, the corresponding variable is fixed; when the sample is a small (i.e., negligible) part of the population the corresponding variable is random”.</p></li>
<li><p>“If an effect is assumed to be a realized value of a random variable, it is called a random effect.”</p></li>
</ol>
<p>So, interpretations of what random vs.&nbsp;fixed effects “really mean” will vary.</p>
<p>But, formally, it isn’t so ambiguous. “Fixed” effects are treated as having “fixed” coefficients whose values we estimate and draw inference on (e.g.&nbsp;with confidence intervals and hypothesis tests).</p>
<p>“Random” effects are treated as having “random” coefficients drawn from some distribution. We won’t estimate individual coefficients, but we will estimate the variance of the distribution from which they came.</p>
<section id="subjects-and-nesting" class="level3" data-number="7.6.1">
<h3 data-number="7.6.1" class="anchored" data-anchor-id="subjects-and-nesting"><span class="header-section-number">7.6.1</span> Subjects and Nesting</h3>
<p>Our main motivation right now is to have a method of accounting for repeated measurements on the same subjects.</p>
<p>So, in this class, we will look at mixed models for which the random effect is “subject”. In other words, we will make models that account for differences between subjects measured multiple times.</p>
<p>In a study in which subjects are assigned to groups, each subject is assigned to one group.</p>
<p>From a modeling perspective, subject is “nested” within group. In general, one variable is nested within the other if values of the nested variable only occur in certain categories of the variable it is nested within.</p>
<p>In this case, cows are nesting within treatments because each cow is measures only in one treatment. A non-nested design would have each cow measured under each value of the other predictors. In other words, each cow would be measured under both treatment.</p>
<p>Another example: say we are doing an education research study and we randomly sample 4 districts in a state, then 3 schools in each district, then 7 classrooms in each school. In this case, classroom is nested within school, and school is nested within district. This is because each classroom exists in only one school, and each school exists in only one district.</p>
<p>The notation for “subject nested within group” is <span class="math inline">\(subject(group)\)</span></p>
</section>
</section>
<section id="the-mixed-effects-model" class="level2" data-number="7.7">
<h2 data-number="7.7" class="anchored" data-anchor-id="the-mixed-effects-model"><span class="header-section-number">7.7</span> The mixed effects model</h2>
<p>A mixed effects model contains both random and fixed effects.</p>
<p>Applying this to the cows example, in which cows are assigned to one of two treatment groups and measured daily for seven days:</p>
<p><span class="math display">\[
\textit{Infection rate}_i = \beta_0 + \beta_1Treatment_i + \beta_2Day_i + \beta_3Treatment_i*Day_i + \alpha_jCow_j(Treatment_i) + \epsilon_i \\
\text{ where } \alpha_j \sim Normal(0, \sigma^2_\alpha) \\
\text{ and } \epsilon_i \sim Normal(0, \sigma^2_\epsilon)
\]</span></p>
<p>Don’t worry too much about the notation details. The most important part is that “Cow” is random, while “Treatment” and “Day” are fixed.</p>
<p>We will not estimate coefficients for the different cows. This model treats each cow as having its own “random intercept”, meaning that the intercept, <span class="math inline">\(\beta_0\)</span>, gets adjusted by some amount for each individual cow.</p>
<p>As we saw in the last set of notes, the purpose of this is to let the model estimate the effects of the “Treatment” and “Day” variables, while taking accounts of the fact that different cows will have different overall mean infection rates.</p>
<section id="the-mixed-effects-model-in-jamovi" class="level3" data-number="7.7.1">
<h3 data-number="7.7.1" class="anchored" data-anchor-id="the-mixed-effects-model-in-jamovi"><span class="header-section-number">7.7.1</span> The mixed effects model in jamovi</h3>
<p>To fit this model in jamovi, use “Linear Models”, select “Mixed Model”, and then add the fixed predictors as factors and covariates and random predictors as cluster variables:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/Mod7_pt2_1.png" class="img-fluid figure-img" width="400"></p>
</figure>
</div>
<p>Note that Cow_ID is the random effect. Treatment, Day, and their interaction are fixed effects.</p>
<p>Note also jamovi will also require you to specify the random effects.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/Mod7_pt2_2.png" class="img-fluid figure-img"></p>
</figure>
</div>
<p>jamovi gives the usual parameter estimates output, as well as a residual plot:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/Mod7_pt2_3.png" class="img-fluid figure-img" width="400"></p>
</figure>
</div>
<p>Notice that “Cow_ID” is not listed under parameter estimates; only fixed coefficients are estimated.</p>
<p>Each cow has its own random coefficient, modeled as having been drawn from a normal distribution.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/Mod7_pt2_4.png" class="img-fluid figure-img"></p>
</figure>
</div>
</section>
<section id="slope-coding-in-mixed-model" class="level3" data-number="7.7.2">
<h3 data-number="7.7.2" class="anchored" data-anchor-id="slope-coding-in-mixed-model"><span class="header-section-number">7.7.2</span> Slope coding in “Mixed Model”</h3>
<p>Notice the categorical predictor “Treatment” lists “Effect” as “A – (B, A)”. jamovi is coding this slope as the difference between Treatment A and the “mean” of Treatments A and B.</p>
<p>So, if we were looking at Treatment B, we’d apply a slope of -0.513.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/Mod7_pt2_5.png" class="img-fluid figure-img"></p>
</figure>
</div>
</section>
</section>
<section id="applied-example-the-liking-gap" class="level2" data-number="7.8">
<h2 data-number="7.8" class="anchored" data-anchor-id="applied-example-the-liking-gap"><span class="header-section-number">7.8</span> Applied example: “The liking gap”</h2>
<p>The journal Psychological Science published many studies in which data are publicly available.</p>
<p>The remaining slides reproduce results from a recent study published in Psychological Science on the difference between how much individuals “like” other people and how much they perceive others “like” them.</p>
<p>The paper is available at: https://doi.org/10.1177%2F0956797618783714</p>
<p>The basic setup is that volunteers were paired up (each pair is called a “dyad”) and directed to have a conversation for five minutes.</p>
<p>After this, participants rated their partners on some survey questions that the authors take as a measure of liking the other person.</p>
<p>Participants also rated how much they thought they were liked.</p>
<p>The study is looking for a “gap” (i.e.&nbsp;difference) between volunteers’ self-perception of how much their partners liked them, and how much their partners actually liked them.</p>
<section id="the-liking-gap-example" class="level3" data-number="7.8.1">
<h3 data-number="7.8.1" class="anchored" data-anchor-id="the-liking-gap-example"><span class="header-section-number">7.8.1</span> The liking gap example</h3>
<p>From the results section of the paper:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/Mod7_pt2_6.png" class="img-fluid figure-img" width="400"></p>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/Mod7_pt2_7.png" class="img-fluid figure-img" width="400"></p>
</figure>
</div>
</section>
<section id="fitting-the-model-in-jamovi" class="level3" data-number="7.8.2">
<h3 data-number="7.8.2" class="anchored" data-anchor-id="fitting-the-model-in-jamovi"><span class="header-section-number">7.8.2</span> Fitting the model in jamovi</h3>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/Mod7_pt2_8.png" class="img-fluid figure-img"></p>
</figure>
</div>
<p><span class="math display">\[
\textit{Liking index}_i = \beta_0 + \beta_1\textit{self_other} + \beta_2Day + \alpha_jpid_j(did_k) + \gamma_kdid_k + \epsilon_i \\
\text{ where } \alpha_{j(k)} \sim Normal(0, \sigma^2_\alpha), \\
\gamma_k \sim Normal(0, \sigma^2_\gamma), \\
\text{ and } \epsilon_i \sim Normal(0, \sigma^2_\epsilon)
\]</span></p>
<p>The model statement starts looking complicated. We have two different random effects, one nested in the other.</p>
<p>The <span class="math inline">\(\alpha\)</span>’s and <span class="math inline">\(\gamma\)</span>’s are modeled as random values.</p>
<p>We have two fixed effects: self_other and Day. Their coefficients will be estimated as normal.</p>
<p><span class="math display">\[
\textit{Liking index}_i = \beta_0 + \beta_1\textit{self_other} + \alpha_jpid_j(did_k) + \gamma_kdid_k + \epsilon_i \\
\text{ where } \alpha_{j(k)} \sim Normal(0, \sigma^2_\alpha), \\
\gamma_k \sim Normal(0, \sigma^2_\gamma), \\
\text{ and } \epsilon_i \sim Normal(0, \sigma^2_\epsilon)
\]</span></p>
<p>The random effect variances, <span class="math inline">\(\sigma^2_\alpha\)</span> and <span class="math inline">\(\sigma^2_\gamma\)</span>, are estimated in the mixed model. These variances could be interpreted, but we will stick to interpreted the fixed effects in this class.</p>
</section>
<section id="adding-an-interaction" class="level3" data-number="7.8.3">
<h3 data-number="7.8.3" class="anchored" data-anchor-id="adding-an-interaction"><span class="header-section-number">7.8.3</span> Adding an interaction…</h3>
<p>The next section of the paper looks at personality variables as predictors:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/Mod7_pt2_9.png" class="img-fluid figure-img" width="400"></p>
</figure>
</div>
<p>In jamovi:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/Mod7_pt2_10.png" class="img-fluid figure-img"></p>
</figure>
</div>
<p>We’ll stop here. The paper goes on through many additional studies, and the data are all available via the supplemental materials link.</p>
</section>
</section>
<section id="replicating-a-published-mixed-model-analysis" class="level2" data-number="7.9">
<h2 data-number="7.9" class="anchored" data-anchor-id="replicating-a-published-mixed-model-analysis"><span class="header-section-number">7.9</span> Replicating a published mixed model analysis</h2>
<p>The remainder of this chapter covers the analysis from a 2017 Psychological Science paper by Goudeau and Croizet, titled:</p>
<p><em>“Hidden Advantages and Disadvantages of Social Class: How Classroom Settings Reproduce Social Inequality by Staging Unfair Comparison”</em></p>
<p>This paper presents three studies on one topic. These notes cover studies 1 and 3; study 2 is reserved for a homework assignment.</p>
<section id="worked-example-overview" class="level3" data-number="7.9.1">
<h3 data-number="7.9.1" class="anchored" data-anchor-id="worked-example-overview"><span class="header-section-number">7.9.1</span> Worked example overview</h3>
<p>This study was performed in France. The data are available at https://osf.io/rkj7y/ and the data file has a codebook sheet that defines the variables:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/Mod7_pt3_1.png" class="img-fluid figure-img"></p>
</figure>
</div>
<p>In each study, 6th grade students are given a challenging reading comprehension assignment.</p>
<p>Performance on the assignment is the dependent variable.</p>
<p>The researchers investigate whether students’ performance is associated with their awareness of their classmates’ performance, and whether this association can be moderated by students’ awareness of the different levels of preparation given to different students.</p>
</section>
<section id="paper-abstract" class="level3" data-number="7.9.2">
<h3 data-number="7.9.2" class="anchored" data-anchor-id="paper-abstract"><span class="header-section-number">7.9.2</span> Paper abstract</h3>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/Mod7_pt3_2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</section>
<section id="study-1" class="level3" data-number="7.9.3">
<h3 data-number="7.9.3" class="anchored" data-anchor-id="study-1"><span class="header-section-number">7.9.3</span> Study 1</h3>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/Mod7_pt3_3.png" class="img-fluid figure-img" width="400"></p>
</figure>
</div>
<ul>
<li><p>The variables used in this study are:</p>
<ul>
<li><p>Performance (response)</p></li>
<li><p>Visibility condition (fixed effect)</p></li>
<li><p>Social class (fixed effect)</p></li>
<li><p>Visibility X Social class interaction (fixed effect)</p></li>
<li><p>School (random effect)</p></li>
<li><p>Classroom, nested within School (random effect)</p></li>
</ul></li>
</ul>
<section id="study-1-model" class="level4" data-number="7.9.3.1">
<h4 data-number="7.9.3.1" class="anchored" data-anchor-id="study-1-model"><span class="header-section-number">7.9.3.1</span> Study 1 model</h4>
<p><span class="math display">\[
\textit{PERF}_i = \beta_0 + \beta_1X_1 + \beta_2X_2 + \beta_3X_1*PCS + \alpha_{j(k)}CLASSE_{j(k)}(ETABLISSEMENT_k) + \gamma_kETABLISSEMENT_k + \epsilon_i \\
\text{ where } \alpha_{j} \sim Normal(0, \sigma^2_\alpha), \\
\gamma_k \sim Normal(0, \sigma^2_\gamma), \\
\text{ and } \epsilon_i \sim Normal(0, \sigma^2_\epsilon)
\]</span></p>
<p>Refer to the codebook for variable definitions</p>
<p>Note that in this study, subjects (students) are only measured once. The repeated measurements are on classrooms and schools.</p>
<p>Also note that PCS compares working class (PCS=1) to upper class (PCS=3.)</p>
</section>
<section id="study-1-in-jmp" class="level4" data-number="7.9.3.2">
<h4 data-number="7.9.3.2" class="anchored" data-anchor-id="study-1-in-jmp"><span class="header-section-number">7.9.3.2</span> Study 1 in JMP</h4>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/Mod7_pt3_4.png" class="img-fluid figure-img"></p>
</figure>
</div>
<p>Note that the response variable, PERF, is score on a reading comprehension test, on a scale of 0 to 20 points.</p>
</section>
<section id="notes-on-study-1-random-effects-output" class="level4" data-number="7.9.3.3">
<h4 data-number="7.9.3.3" class="anchored" data-anchor-id="notes-on-study-1-random-effects-output"><span class="header-section-number">7.9.3.3</span> Notes on Study 1 random effects output</h4>
<p>“The random effects covariance parameter estimates” table shows that there is much more residual (error) variance than there is variance across classrooms or across schools.</p>
<p>One very odd result: the classroom variance estimate is negative! But variances cannot be negative.</p>
<p>If we had deselected “unbounded variance estimates” under Fit Model, this would be zeroed out. It is a strange quirk of maximum likelihood variance estimation that negative estimates are possible. We can ignore this, and treat the classroom variance as just very small.</p>
</section>
<section id="notes-on-study-1-fixed-effects-output" class="level4" data-number="7.9.3.4">
<h4 data-number="7.9.3.4" class="anchored" data-anchor-id="notes-on-study-1-fixed-effects-output"><span class="header-section-number">7.9.3.4</span> Notes on Study 1 fixed effects output</h4>
<p>We see strong “main effects” for visibility condition (X1), social class (PCS), and their interaction.</p>
<p>A general principle for models with strong interactions is that our interpretation should focus on the interactions.</p>
<p><img src="images/Mod7_pt3_5.png" class="img-fluid"></p>
<p>Here, the interaction coefficient is -2.69, and the coefficient for <span class="math inline">\(X_1\)</span> is 1.12.</p>
<p>For the Effect of <span class="math inline">\(X_1\)</span> “-1 - 1” refers to the “differences not visible” condition, in which students do not raise their hands when they have the answer. For the Effect of PCS “3 - 1” refers to change in score for upper class students vs.&nbsp;working class students. So, the “effect” of visibility seems to apply to working class students but not to upper class students, since –2.69 and 1.12 nearly cancel each other out.</p>
</section>
<section id="plotting-the-fixed-effects" class="level4" data-number="7.9.3.5">
<h4 data-number="7.9.3.5" class="anchored" data-anchor-id="plotting-the-fixed-effects"><span class="header-section-number">7.9.3.5</span> Plotting the fixed effects</h4>
<p>Here is the plot reported in the paper, and the same plot in JMP:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/Mod7_pt3_6.png" class="img-fluid figure-img"></p>
</figure>
</div>
<p>The practice of using a bar plot to show means is common, but flawed. The bars don’t mean anything; all they do is go up to the means.</p>
<p>Here is what this looks like using boxplots instead.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/Mod7_pt3_7.png" class="img-fluid figure-img" width="400"></p>
</figure>
</div>
<p>Notice that this plot shows variability in the data, where the bar plot does not.</p>
</section>
</section>
<section id="study-3" class="level3" data-number="7.9.4">
<h3 data-number="7.9.4" class="anchored" data-anchor-id="study-3"><span class="header-section-number">7.9.4</span> Study 3</h3>
<p>In Study 2, social class is not used. Rather, some students are given better preparation for the reading comprehension test than others.</p>
<p>Similar results are found: those with worse preparation perform more poorly when students are told to raise their hands after determining the answer.</p>
<p>In Study 3, the authors attempt to “undo” this effect by informing the class that some students were given better preparation than others. Half the classrooms are made aware of this; the other half are not.</p>
<p>The variables in this study are almost the same as in study 1, with these changes:</p>
<ul>
<li><p>X1 is “context”:</p>
<ul>
<li><p>-1 = awareness of the disadvantage</p></li>
<li><p>1 = unawareness of the disadvantage</p></li>
</ul></li>
<li><p>X2 is “level of familiarity” with the reading material, based on intentional preparation given by the researchers:</p>
<ul>
<li><p>-1 = high level</p></li>
<li><p>1 = low level</p></li>
</ul></li>
</ul>
<section id="study-3-model" class="level4" data-number="7.9.4.1">
<h4 data-number="7.9.4.1" class="anchored" data-anchor-id="study-3-model"><span class="header-section-number">7.9.4.1</span> Study 3 model</h4>
<p><span class="math display">\[
\textit{PERF}_i = \beta_0 + \beta_1X_1 + \beta_2X_2 + \beta_3X_1*X_2 + \alpha_{j}CLASSE_{j}+ \epsilon_i \\
\text{ where } \alpha_{j} \sim Normal(0, \sigma^2_\alpha), \\
\text{ and } \epsilon_i \sim Normal(0, \sigma^2_\epsilon)
\]</span></p>
<p>In this data set, there is no variable for “school”, only one for “classroom”. This isn’t explained in the paper.</p>
</section>
<section id="study-3-in-jamovi" class="level4" data-number="7.9.4.2">
<h4 data-number="7.9.4.2" class="anchored" data-anchor-id="study-3-in-jamovi"><span class="header-section-number">7.9.4.2</span> Study 3 in jamovi</h4>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/Mod7_pt3_8.png" class="img-fluid figure-img"></p>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/Mod7_pt3_9.png" class="img-fluid figure-img"></p>
</figure>
</div>
<p>As with before, the variance across classrooms is very small relative to the error variance.</p>
<p>The largest overall effect is <span class="math inline">\(X_2\)</span>: level of familiarity with the material. Students who are better prepared score higher.</p>
<p>The negative interaction shows that the difference in performance between those with higher vs.&nbsp;low familiarity is lower when students are aware of the difference in familiarity.</p>
<p>The interaction of -5.81 just about cancels out the estimated slope for <span class="math inline">\(X_1\)</span>[-1] of 4.24.</p>
<p>This shows that there is very little difference in scores between students with high preparation who are and are not aware of the advantage.</p>
<p>It helps to look at the data.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/Mod7_pt3_11.png" class="img-fluid figure-img" width="400"></p>
</figure>
</div>
<p>The generic “<span class="math inline">\(X_1\)</span>” and “<span class="math inline">\(X_2\)</span>” have been replaced with more meaningful titles.</p>
<p>And here are the bar plots shows in the paper.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/Mod7_pt3_12.png" class="img-fluid figure-img" width="400"></p>
</figure>
</div>
<p>Again, the boxplots show more information.</p>
<p>In this case, the boxplots reveal a potentially concerned “ceiling effect”: many students earned the maximum possible score. This can’t be seen from the bar plot.</p>


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./Ch6_GLMs.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Generalized Linear Models (GLMs)</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./Ch8_Mind_the_Gap.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Chapter 8: Minding the gap between science and statistics</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>