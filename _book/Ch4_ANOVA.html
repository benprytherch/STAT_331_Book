<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.361">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>STAT 331 - 4&nbsp; Chapter 4: ANOVA-based methods</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./Ch5_Categorical.html" rel="next">
<link href="./Ch3_Model_Fit.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./Ch4_ANOVA.html"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Chapter 4: ANOVA-based methods</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">STAT 331</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction to STAT 331: Intermediate Applied Statistical Methods</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Ch1_Review.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Chapter 1: Review of classical inference</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Ch2_Model_Building.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Chapter 2: Model building with linear regression</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Ch3_Model_Fit.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Chapter 3: Assessing and improving model fit</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Ch4_ANOVA.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Chapter 4: ANOVA-based methods</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Ch5_Categorical.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Chapter 5: Analyzing categorical data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Ch6_GLMs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Generalized Linear Models (GLMs)</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Ch7_Mixed.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Chapter 7: Mixed-effects models</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Ch8_Mind_the_Gap.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Chapter 8: Minding the gap between science and statistics</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Ch9_Other_Topics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Brief looks at major topics we didnâ€™t cover</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#what-is-anova" id="toc-what-is-anova" class="nav-link active" data-scroll-target="#what-is-anova"><span class="header-section-number">4.1</span> What is ANOVA?</a>
  <ul class="collapse">
  <li><a href="#anova-is-regression-presented-differently" id="toc-anova-is-regression-presented-differently" class="nav-link" data-scroll-target="#anova-is-regression-presented-differently"><span class="header-section-number">4.1.1</span> ANOVA is regression presented differently</a></li>
  <li><a href="#indicator-variables" id="toc-indicator-variables" class="nav-link" data-scroll-target="#indicator-variables"><span class="header-section-number">4.1.2</span> Indicator variables</a></li>
  </ul></li>
  <li><a href="#one-way-anova" id="toc-one-way-anova" class="nav-link" data-scroll-target="#one-way-anova"><span class="header-section-number">4.2</span> One-Way ANOVA</a></li>
  <li><a href="#factorial-anova" id="toc-factorial-anova" class="nav-link" data-scroll-target="#factorial-anova"><span class="header-section-number">4.3</span> Factorial ANOVA</a>
  <ul class="collapse">
  <li><a href="#factorial-anova-example" id="toc-factorial-anova-example" class="nav-link" data-scroll-target="#factorial-anova-example"><span class="header-section-number">4.3.1</span> Factorial ANOVA example</a></li>
  <li><a href="#eta-squared-and-partial-eta-squared" id="toc-eta-squared-and-partial-eta-squared" class="nav-link" data-scroll-target="#eta-squared-and-partial-eta-squared"><span class="header-section-number">4.3.2</span> Eta-squared and partial eta-squared</a></li>
  <li><a href="#the-means-interaction-plot" id="toc-the-means-interaction-plot" class="nav-link" data-scroll-target="#the-means-interaction-plot"><span class="header-section-number">4.3.3</span> The means / interaction plot</a></li>
  <li><a href="#anova-diagnostics" id="toc-anova-diagnostics" class="nav-link" data-scroll-target="#anova-diagnostics"><span class="header-section-number">4.3.4</span> ANOVA diagnostics</a></li>
  <li><a href="#doing-all-of-this-as-regression" id="toc-doing-all-of-this-as-regression" class="nav-link" data-scroll-target="#doing-all-of-this-as-regression"><span class="header-section-number">4.3.5</span> Doing all of this as regression</a></li>
  </ul></li>
  <li><a href="#ancova" id="toc-ancova" class="nav-link" data-scroll-target="#ancova"><span class="header-section-number">4.4</span> ANCOVA</a>
  <ul class="collapse">
  <li><a href="#analyzing-paired-data-ancova-vs-anova" id="toc-analyzing-paired-data-ancova-vs-anova" class="nav-link" data-scroll-target="#analyzing-paired-data-ancova-vs-anova"><span class="header-section-number">4.4.1</span> Analyzing paired data: ANCOVA vs ANOVA</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Chapter 4: ANOVA-based methods</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="what-is-anova" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="what-is-anova"><span class="header-section-number">4.1</span> What is ANOVA?</h2>
<p>â€¢ ANOVA stands for â€œanalysis of varianceâ€</p>
<p>â€¢ ANOVA is regression with categorical predictors. Thatâ€™s it.</p>
<section id="anova-is-regression-presented-differently" class="level3" data-number="4.1.1">
<h3 data-number="4.1.1" class="anchored" data-anchor-id="anova-is-regression-presented-differently"><span class="header-section-number">4.1.1</span> ANOVA is regression presented differently</h3>
<p>â€¢ OK, thereâ€™s more to say about ANOVA than just â€œregression with categorical predictors.â€</p>
<p>â€¢ ANOVA is typically used to analyze data from experiments. In experiments, the categorical predictors are usually groups to which experimental units (aka subjects) are assigned. â€¢ ANOVA tends to focus on comparing means of different groups to one another. â€¢ Although ANOVA is â€œjustâ€ regression, there are conventions for reporting ANOVA results that are simpler and cleaner than what weâ€™ve seen for regression.</p>
</section>
<section id="indicator-variables" class="level3" data-number="4.1.2">
<h3 data-number="4.1.2" class="anchored" data-anchor-id="indicator-variables"><span class="header-section-number">4.1.2</span> Indicator variables</h3>
<p>â€¢ Weâ€™ve seen how to incorporate a categorical predictor into a regression model when the predictor takes on two values. We create an â€œindicatorâ€ (aka â€œdummyâ€ aka â€œbinaryâ€) variable that takes on the values 0 or 1. For example:</p>
<p>Yğ‘– = ğ›½0 + ğ›½1ğ‘¥ğ‘– + ğœ€ğ‘–</p>
<p>ğ‘¥ğ‘– = 1 if â€œtreamentâ€; ğ‘¥ğ‘– = 0 if â€œcontrolâ€</p>
<p>â€¢ Here,</p>
<p>ğ‘¦à·ğ‘– =</p>
<p>ğ›½áˆ˜</p>
<p>for control, and</p>
<p>ğ‘¦à·ğ‘–</p>
<p>= ğ›½áˆ˜</p>
<ul>
<li>ğ›½áˆ˜</li>
</ul>
<p>for treatment.</p>
<p>â€¢ What if our categorical predictor takes on more than two categories? Suppose we have three groups: treatment 1, treatment 2, and control. We can add another indicator:</p>
<p>Yğ‘– = ğ›½0 + ğ›½1ğ‘¥ğ‘–1 + ğ›½2ğ‘¥ğ‘–2 + ğœ€ğ‘–</p>
<p>ğ‘¥1ğ‘– = 1 if trtmt 1 and 0 otherwise; ğ‘¥2ğ‘– = 1 if trtmt 2 and 0 otherwise</p>
<p>â€¢ ğ‘¦à·ğ‘– =</p>
<p>ğ›½áˆ˜</p>
<p>for control,</p>
<p>ğ‘¦à·ğ‘–</p>
<p>= ğ›½áˆ˜</p>
<ul>
<li>ğ›½áˆ˜</li>
</ul>
<p>for trtmt 1,</p>
<p>ğ‘¦à·ğ‘–</p>
<p>= ğ›½áˆ˜</p>
<ul>
<li>ğ›½áˆ˜</li>
</ul>
<p>for trtmt 2.</p>
<p>â€¢ Control is serving as the â€œbaselineâ€ category, represented by the intercept.</p>
</section>
</section>
<section id="one-way-anova" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="one-way-anova"><span class="header-section-number">4.2</span> One-Way ANOVA</h2>
<p>â€¢ One-way ANOVA models have a single categorical predictor variable. They can be written as:</p>
<p>ğ‘¦ğ‘–ğ‘— = ğœ‡ + ğ›¼ğ‘— + ğœ€ğ‘–ğ‘—, ğœ€ğ‘–ğ‘—~ğ‘ğ‘œğ‘Ÿğ‘šğ‘ğ‘™ , i = 1 â€¦ nj, j = 1 â€¦ p</p>
<p>â€¢ Where there are â€œpâ€ groups (i.e.&nbsp;the categorical predictor takes on â€œpâ€ values), â€œğ‘›ğ‘—â€ is the sample size of the ğ‘—ğ‘¡â„ group, and ğ‘¦ğ‘–ğ‘— is the ğ‘–ğ‘¡â„ observation in the ğ‘—ğ‘¡â„ group.</p>
<p>â€¢ Here, ğœ‡ is the overall mean and ğ›¼ğ‘— is the deviation of the ğ‘—ğ‘¡â„ group</p>
<p>â€¢ Suppose we have 4 groups. The ANOVA model is:</p>
<p>ğ‘¦ğ‘–ğ‘— = ğœ‡ + ğ›¼ğ‘— + ğœ€ğ‘–ğ‘—, ğœ€ğ‘–ğ‘—~ğ‘ğ‘œğ‘Ÿğ‘šğ‘ğ‘™</p>
<p>â€¢ Written as a regression model instead:</p>
<p>, i = 1 â€¦ nj, j = 1 â€¦ 4</p>
<p>ğ‘¦ğ‘– = ğ›½0 + ğ›½1ğºğ‘Ÿğ‘œğ‘¢ğ‘1 + ğ›½2ğºğ‘Ÿğ‘œğ‘¢ğ‘2 + ğ›½3ğºğ‘Ÿğ‘œğ‘¢ğ‘3 + ğœ€ğ‘–,</p>
<p>ğœ€ğ‘–~ğ‘ğ‘œğ‘Ÿğ‘šğ‘ğ‘™</p>
<p>, ğ‘– = 1 â€¦ ğ‘›</p>
<p>â€¢ Here, the â€œGroupâ€ predictors are 0 / 1 indicator variables. For</p>
</section>
<section id="factorial-anova" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="factorial-anova"><span class="header-section-number">4.3</span> Factorial ANOVA</h2>
<p>â€¢ If we have more than one categorical predictor variable, and interactions between the predictors, we have a factorial ANOVA model. Generically:</p>
<p>ğ‘¦ğ‘–ğ‘—ğ‘˜ = ğœ‡ + ğ›¼ğ‘— + ğ›½ğ‘˜ + ğ‘—ğ‘˜ + ğœ€ğ‘–ğ‘—ğ‘˜, ğœ€ğ‘–ğ‘—ğ‘˜~ğ‘ğ‘œğ‘Ÿğ‘šğ‘ğ‘™</p>
<p>i = 1 â€¦ njk, j = 1 â€¦ p, k = 1 â€¦ q</p>
<p>â€¢ Now predictor 1 is ğ›¼ and predictor 2 is ğ›½ and they interact. There are â€œpâ€ groups for predictor 1 and â€œqâ€ groups for predictor 2.</p>
<p>â€¢ The subscripts start getting messy pretty fast.</p>
<section id="factorial-anova-example" class="level3" data-number="4.3.1">
<h3 data-number="4.3.1" class="anchored" data-anchor-id="factorial-anova-example"><span class="header-section-number">4.3.1</span> Factorial ANOVA example</h3>
<p>â€¢ Hereâ€™s an example of a â€œ5x2 factorialâ€ ANOVA, meaning that one variable has 5 groups and the other has 2.</p>
<p>â€¢ The study is on memory: how many words, on average, do people recall when given certain processing tasks?</p>
<p>â€¢ This example is where the graph on our Canvas home page comes from. It uses data simulated to mimic data from a 1974 Hans Eysenck study.</p>
<p>â€¢ 100 subjects were split into 5 recall groups:</p>
<p>â€¢ â€œCountingâ€: subjects counted how many letters were in each presented word â€¢ â€œRhymingâ€ subjects thought of words that rhymed with each presented word â€¢ â€œAdjectiveâ€: subjects thought of an adjective that could be used to modify each presented word â€¢ â€œImageryâ€: subjects were told to form vivid images of each word â€¢ â€œIntentionalâ€: subjects were told to memorize the word for later recall</p>
<p>â€¢ Counting and rhyming are lower level processing tasks, so the hypothesis was that this group would recall fewer words than the others. Subjects were also classified as â€œyoungâ€ or â€œoldâ€.</p>
<p>â€¢ Hereâ€™s the ANOVA model:</p>
<p>ğ‘…ğ‘’ğ‘ğ‘ğ‘™ğ‘™ğ‘–ğ‘—ğ‘˜ = ğœ‡ + ğºğ‘Ÿğ‘œğ‘¢ğ‘ğ‘— + ğ´ğ‘”ğ‘’ğ‘˜ + (ğºğ‘Ÿğ‘œğ‘¢ğ‘ âˆ™ ğ´ğ‘”ğ‘’)ğ‘—ğ‘˜ + ğœ€ğ‘–ğ‘—ğ‘˜</p>
<p>ğœ€ğ‘–ğ‘—ğ‘˜~ğ‘ğ‘œğ‘Ÿğ‘šğ‘ğ‘™</p>
<p>, ğ‘— = 1 â€¦ 5, ğ‘˜ = 1,2</p>
<p>â€¢ Jamovi has an â€œANOVAâ€ function and a â€œregressionâ€ function. Weâ€™ll use both the analyze these data.</p>
<p>â€¢ First weâ€™ll use ANOVA, using items recalled as the response (dependent) variable, and recall condition and age as factors. Note that jamovi automatically includes their interaction.</p>
<p>â€¢ I am usually not interested in the sums of squares or mean squares in the ANOVA table, as these are not interpretable. We do have p-values for each â€œmain effectâ€ along with the interaction. More importantly, we have effect size statistics: eta-squared (ğœ‚2) and partial eta-squared (ğœ‚2ğ‘)</p>
</section>
<section id="eta-squared-and-partial-eta-squared" class="level3" data-number="4.3.2">
<h3 data-number="4.3.2" class="anchored" data-anchor-id="eta-squared-and-partial-eta-squared"><span class="header-section-number">4.3.2</span> Eta-squared and partial eta-squared</h3>
<p>â€¢ ğœ‚2 is akin to ğ‘…2 for one factor (main effect or interaction). It gives the proportion of variance in the response attributable to the factor in question:</p>
<p>ğœ‚2 = ğ‘†ğ‘†ğ‘“ğ‘ğ‘ğ‘¡ğ‘œğ‘Ÿ ğ‘†ğ‘†ğ‘¡ğ‘œğ‘¡ğ‘ğ‘™</p>
<p>â€¢ Here, we see that recall condition explains the most variance by far, followed by age, followed by their interaction.</p>
<p>ANOVA effect sizes: ğœ‚2 and partial-ğœ‚2</p>
<p>â€¢ ğœ‚2ğ‘ (partial eta-squared) is like ğœ‚2, but with the variance accounted for by the other factors removed from the denominator:</p>
<p>ğœ‚2ğ‘ = ğ‘†ğ‘†ğ‘“ğ‘ğ‘ğ‘¡ğ‘œğ‘Ÿ ğ‘†ğ‘†ğ‘“ğ‘ğ‘ğ‘¡ğ‘œğ‘Ÿ+ğ‘†ğ‘†ğ‘Ÿğ‘’ğ‘ ğ‘–ğ‘‘ğ‘¢ğ‘ğ‘™ğ‘  â€¢ Example: for recall condition,</p>
<p>ğœ‚2ğ‘ = 1515 1515+722</p>
<p>= 0.677, ğœ‚2 = 1515 1515+240+190+722</p>
<p>= 0.568</p>
<p>â€¢ I personally prefer ğœ‚2, as their sum cannot exceed 1. Some prefer ğœ‚2ğ‘, because it quantifies the â€œeffectâ€ of a factor relative to remaining unexplained variance,</p>
</section>
<section id="the-means-interaction-plot" class="level3" data-number="4.3.3">
<h3 data-number="4.3.3" class="anchored" data-anchor-id="the-means-interaction-plot"><span class="header-section-number">4.3.3</span> The means / interaction plot</h3>
<p>â€¢ We can make a nice plot under â€œestimated marginal meansâ€:</p>
<p>â€¢ This plot shows every combination of means across recall condition and age. It also has 95% CIs around each mean, and raw data displayed.</p>
<p>â€¢ This is sometimes called a â€œmeans plotâ€ or an â€œinteraction plotâ€. The interaction is represented by non-parallel lines, e.g.&nbsp;a positive change going from â€œImageryâ€ to â€œIntentionâ€ for young people, but a negative change for old people.</p>
<p>â€¢ The previous plot showed means for recall condition, with separate lines for age. If we flip the order of the variables, we get this:</p>
<p>â€¢ Here we see that mean items recalled for young people is substantially higher than for old people in the last three conditions, but differs only slightly in the first two conditions.</p>
</section>
<section id="anova-diagnostics" class="level3" data-number="4.3.4">
<h3 data-number="4.3.4" class="anchored" data-anchor-id="anova-diagnostics"><span class="header-section-number">4.3.4</span> ANOVA diagnostics</h3>
<p>â€¢ We can also run diagnostic tests, under â€œAssumption checksâ€: â€¢ The QQ plot looks pretty good.</p>
<p>â€¢ I personally do not recommend paying attention to Leveneâ€™s â€œhomogeneity of variancesâ€ test, nor to the Shapiro-Wilk normality tests â€¢ These tests use null hypotheses of â€œpopulation variance is the same in all groupsâ€, or â€œthe residuals were drawn from a normal distributionâ€. As I donâ€™t think these model assumptions could be literally true, I am not interested in whether they can be rejected by the data.</p>
<p>â€¢ A â€œsignificantâ€ violation of modeling assumptions does not imply a consequential violation. In particular, if sample size is large, trivial violations of assumption</p>
</section>
<section id="doing-all-of-this-as-regression" class="level3" data-number="4.3.5">
<h3 data-number="4.3.5" class="anchored" data-anchor-id="doing-all-of-this-as-regression"><span class="header-section-number">4.3.5</span> Doing all of this as regression</h3>
<p>â€¢ The beginning of these slides claimed that ANOVA is just regression with categorical predictors. Letâ€™s see what our results look like if we use jamoviâ€™s â€œlinear regressionâ€ function rather than â€œANOVAâ€. â€¢ The predictor variables are entered as â€œfactorsâ€ here, rather than as â€œcovariatesâ€, to ensure they are treated as categorical rather than as quantitative variables. â€¢ Finally, the interaction must be specified under â€œmodel builderâ€; jamovi does not create regression interactions by default.</p>
<p>â€¢ There are five recall condition groups, giving four indicator variables, all compared against the baseline group â€œcountingâ€, whose mean is represented by the intercept.</p>
<p>â€¢ There are two â€œageâ€ groups; â€œyoungâ€ is the baseline group.</p>
<p>â€¢ So the intercept of 6.500 is the mean words recalled for a young person in the â€œcountingâ€ condition.</p>
<p>â€¢ The first indicator under RecallCondition is â€œRhyming â€“ Countingâ€. Its slope of 1.1 is the difference in mean recall for these two groups, when Age = Young</p>
<p>â€¢ The interaction slope for â€œRhyming â€“ Countingâ€ is -1.2.</p>
<p>â€¢ So, for Age = Old, the difference in</p>
<p>mean recall is 1.1 +</p>
<p>= âˆ’0.1</p>
<p>â€¢ The interaction terms are all indicators, that â€œturn onâ€ when Age = Old, and â€œturn offâ€ when Age = Young.</p>
<p>â€¢ Notice that the slope for Age (â€œOld â€“ Youngâ€) is 0.5, suggesting greater recall for older participants. â€¢ However, the interaction slopes are all larger negative values.</p>
<p>â€¢ So, when RecallCondition = Counting, the mean items recalled for Age = Old is larger than for Age = Young. But for all other recall conditions, the interaction slopes turn this negative, and mean items recalled is larger for younger participants.</p>
<p>â€¢ â€œEstimated Marginal Meansâ€ under regression will produce a similar plot to the one made under ANOVA, just without the connecting lines and raw data:</p>
<p>â€¢ If you look carefully, you should be able to see how the regression results correspond to this plot. For instance, we see that the only condition where Old &gt; Young is Counting.</p>
<p>â€¢ We can get a plot of residuals vs.&nbsp;fitted values.</p>
<p>â€¢ Notice that the residuals are all vertically stacked? This is to be expected when predictor variables are categorical.</p>
<p>â€¢ In this case, there are 5x2 = 10 possible combinations of groups that participants could be assigned to. And so there are only 10 possible â€œfittedâ€ (i.e.&nbsp;predicted) values that the model can produce.</p>
</section>
</section>
<section id="ancova" class="level2" data-number="4.4">
<h2 data-number="4.4" class="anchored" data-anchor-id="ancova"><span class="header-section-number">4.4</span> ANCOVA</h2>
<p>â€¢ ANCOVA (analysis of covariance) is ANOVA with an additional continuous predictor variable.</p>
<p>â€¢ Typically, this additional continuous predictor is not of primary interest; the primary interest is still comparing group means.</p>
<p>â€¢ The continuous predictor is often thought of as a â€œcovariateâ€ â€“ a variable that should be accounted for when drawing inference on the other variables.</p>
<p>â€¢ A common use of ANCOVA is for modeling an outcome when â€œbaselineâ€ or â€œpre-studyâ€ or â€œpre-testâ€ scores are available.</p>
<p>â€¢ For instance, consider testing different educational models on different sections of a class. Some get traditional lecture, some are completely â€œflippedâ€, and some are a combination of the two.</p>
<p>â€¢ In this study, a preliminary quiz is given on the first day of class. Score on the preliminary quiz will be the covariate. Score on an end of semester quiz (â€œpostâ€) will be the response variable.</p>
<p>ğ‘ƒğ‘œğ‘ ğ‘¡ğ‘–ğ‘— = ğœ‡ + ğ‘¡ğ‘¦ğ‘ğ‘’ğ‘— + ğ›½ + ğœ€ğ‘–ğ‘—</p>
<p>â€¢ Here, j goes from 1 to 3, for the three teaching types being compared.</p>
<p>â€¢ The pre-test predictor is centered (note that ğ‘ğ‘Ÿğ‘’ is mean for pretests).</p>
<p>â€¢ Imagine we believe that the mean differences between teaching types will be larger for students with lower pretest scores. To account for this possibility, let type and (centered) pretest interact:</p>
<p>ğ¶ğ‘œğ‘¢ğ‘Ÿğ‘ ğ‘’_ğ‘ğ‘£ğ‘”ğ‘–ğ‘— = ğœ‡ + ğ‘¡ğ‘¦ğ‘ğ‘’ğ‘— + ğ›½ ğ‘ğ‘Ÿğ‘’ğ‘–ğ‘— âˆ’ ğ‘ğ‘Ÿğ‘’ +ğ›¾ğ‘—(ğ‘¡ğ‘¦ğ‘ğ‘’ğ‘—)(ğ‘ğ‘Ÿğ‘’ğ‘–ğ‘— âˆ’ ğ‘ğ‘Ÿğ‘’) + ğœ€ğ‘–ğ‘—</p>
<p>â€¢ The data file is called â€œtest_pretestâ€. Here is the formatting:</p>
<p>â€¢ This plot was made using Analyses / Exploration / Scatterplot. Density curves are there, just for fun:</p>
<p>â€¢ The three lines look pretty close to parallel, so there either isnâ€™t an obvious interaction here, or itâ€™s small.</p>
<p>â€¢ Notice that the effect size for pre- score is far greater than the effect size for type, or for the interaction. This is not surprising.</p>
<p>â€¢ Type is still significant; itâ€™s ğœ‚2ğ‘ value is much larger than its ğœ‚2 value.</p>
<p>â€¢ Careful interpreting the â€œEstimated marginal meansâ€ plot â€“ it takes into account only â€œpostâ€ scores!</p>
<p>â€¢ For the regression analysis, weâ€™ll use two indicator variables. We donâ€™t have to do it this way; if we just include â€œtypeâ€, jamovi will create the indicators for us, using the first class type listed in the data.</p>
<p>â€¢ Notice that the interaction estimates are small relative to their standard errors (thus producing large p- values).</p>
<p>â€¢ According to this regression model, there is not a â€œsignificantâ€ interaction.</p>
<p>Analysis using regression w/factor</p>
<p>â€¢ Hereâ€™s what happens if we put in â€œtypeâ€ as a factor variable rather than making our own indicators. The results are the same.</p>
<p>â€¢ The QQ plot and residual plot both look great</p>
<section id="analyzing-paired-data-ancova-vs-anova" class="level3" data-number="4.4.1">
<h3 data-number="4.4.1" class="anchored" data-anchor-id="analyzing-paired-data-ancova-vs-anova"><span class="header-section-number">4.4.1</span> Analyzing paired data: ANCOVA vs ANOVA</h3>
<p>â€¢ Another approach we could take would be to compute the differences in the two scores for each person, then do a regular ANOVA or regression analysis on those.</p>
<p>â€¢ We see that there are significant differences in mean test score change between teaching types (F=8.94, p&lt;0.001)</p>
<p>Analyze differences, regression approach</p>
<p>â€¢ This agrees with the ANOVA results from the previous slide: we have a statistically significant difference in mean test score differences (post â€“ pre) when comparing â€œcomboâ€ to â€œflippedâ€ or â€œtraditionalâ€. And ğ‘…2 = ğœ‚2!</p>
<p>â€¢ It turns out here that taking the post â€“ pre differences first and then comparing mean differences across teaching types produces similar results to predicting post-test scores using pre-test and teaching type as predictors.</p>
<p>â€¢ But, these methods are not answering the exact same question. Using pre-test as a covariate, we answer the question â€œwhat difference do I expect in post-test scores when comparing two students with the same pre- test score but different teaching typesâ€?</p>
<p>â€¢ When differencing first and then doing the analysis, we answer the question â€œwhat differences in the mean post-pre score change do I expect when comparing class typesâ€?</p>
<p>â€¢ These question sound similar, but they arenâ€™t the same! Whether to use ANCOVA or do the differencing first is a matter of subjective judgement, and the experts donâ€™t all agree (see â€œLordâ€™s Paradoxâ€ for more fun on this).</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "î§‹";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./Ch3_Model_Fit.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Chapter 3: Assessing and improving model fit</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./Ch5_Categorical.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Chapter 5: Analyzing categorical data</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>